---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getProjects, getProjectBySlug } from '../../lib/strapi';

export async function getStaticPaths() {
  const { data: projects } = await getProjects(1, 100);
  return projects.map((p: any) => ({ params: { slug: p.slug } }));
}

const { slug } = Astro.params;
const { data: projects } = await getProjectBySlug(slug!);
const project = projects[0];

if (!project) return Astro.redirect('/404');
---

<BaseLayout
  title={project.seo?.metaTitle || project.title}
  description={project.seo?.metaDescription || project.description}
>
  <article>
    <h1>{project.title}</h1>
    <div class="links">
      {project.repositoryUrl && <a href={project.repositoryUrl} target="_blank" rel="noopener">GitHub</a>}
      {project.liveUrl && <a href={project.liveUrl} target="_blank" rel="noopener">Live</a>}
    </div>
    <div class="content">
      <p>Content rendering placeholder</p>
    </div>
  </article>
</BaseLayout>

<style>
  article { max-width: 800px; }
  .links { display: flex; gap: 1rem; margin: 1rem 0 2rem; }
  .links a { padding: 0.5rem 1rem; border: 1px solid #6366f1; border-radius: 6px; color: #6366f1; text-decoration: none; font-weight: 500; }
  .links a:hover { background: #6366f1; color: white; }
</style>
