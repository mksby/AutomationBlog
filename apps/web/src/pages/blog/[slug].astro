---
import BlogPostLayout from "@/layouts/BlogPostLayout.astro";
import { getArticles, getArticleBySlug } from "@/lib/strapi";

export async function getStaticPaths() {
  const { data: articles } = await getArticles(1, 100);
  return articles.map((article: any) => ({
    params: { slug: article.slug },
  }));
}

const { slug } = Astro.params;
const { data: articles } = await getArticleBySlug(slug!);
const article = articles[0];

if (!article) return Astro.redirect("/404");
---

<BlogPostLayout article={article} />
